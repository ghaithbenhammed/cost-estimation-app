<div class="container mt-4 p-4 shadow-sm rounded bg-white">
  <h2>ğŸ“‹ Nomenclature des matÃ©riaux</h2>

  <div *ngIf="readonlyMode" class="alert alert-info mt-3">
    ğŸ”’ Cette nomenclature est en lecture seule car la demande est terminÃ©e.
  </div>

  <div class="row mb-4">
    <div class="col-md-6">
      <p><strong>Dossier :</strong> {{ bomHeader?.Design_File_no }}</p>
      <p><strong>Objet :</strong> {{ bomHeader?.No }}</p>
    </div>
    <div class="col-md-6">
      <p><strong>Client :</strong> {{ customerName }} ({{ customerNo }})</p>
      <p>
        <strong>Date :</strong>
        <input
          type="date"
          class="form-control w-auto d-inline"
          [(ngModel)]="nomenclatureDate"
          [disabled]="readonlyMode"
          title="Date de crÃ©ation de la nomenclature"
        />
      </p>
      <p><strong>QuantitÃ© :</strong> 01</p>
    </div>
  </div>

  <h5 class="text-secondary">ğŸ”— Lignes rÃ©cupÃ©rÃ©es depuis Navision</h5>
  <table class="table table-hover table-bordered mt-3">
    <thead class="table-light">
      <tr>
        <th>Code</th>
        <th>DÃ©signation</th>
        <th>UnitÃ©</th>
        <th>QuantitÃ©</th>
        <th>Remarque</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let ligne of bomLines; let i = index"
        [ngClass]="{ 'table-active': i % 2 === 0 }"
      >
        <td>{{ ligne.No }}</td>
        <td>{{ ligne.Description }}</td>
        <td>{{ ligne.Unit_of_Measure_Code }}</td>
        <td>{{ ligne.Quantity_per }}</td>
        <td>
          <input
            class="form-control"
            [(ngModel)]="ligne.remarque"
            placeholder="Ajouter une remarque..."
            title="Remarque pour cette ligne"
            [disabled]="readonlyMode"
          />
        </td>
      </tr>
    </tbody>
  </table>

  <h5 class="text-secondary mt-5">â• Lignes ajoutÃ©es manuellement</h5>
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>Code</th>
        <th>DÃ©signation</th>
        <th>UnitÃ©</th>
        <th>QuantitÃ©</th>
        <th>Remarque</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ligne of customBomLines">
        <td>
          <input
            class="form-control"
            [(ngModel)]="ligne.code"
            placeholder="Code"
            title="Code"
            [disabled]="readonlyMode"
          />
        </td>
        <td>
          <input
            class="form-control"
            [(ngModel)]="ligne.designation"
            placeholder="DÃ©signation"
            title="DÃ©signation"
            [disabled]="readonlyMode"
          />
        </td>
        <td>
          <input
            class="form-control"
            [(ngModel)]="ligne.unite"
            placeholder="UnitÃ©"
            title="UnitÃ©"
            [disabled]="readonlyMode"
          />
        </td>
        <td>
          <input
            type="number"
            class="form-control"
            [(ngModel)]="ligne.quantite"
            placeholder="QuantitÃ©"
            title="QuantitÃ©"
            [disabled]="readonlyMode"
          />
        </td>
        <td>
          <input
            class="form-control"
            [(ngModel)]="ligne.remarque"
            placeholder="Remarque"
            title="Remarque"
            [disabled]="readonlyMode"
          />
        </td>
      </tr>
    </tbody>
  </table>

  <button
    class="btn btn-outline-primary mb-3"
    (click)="addCustomLine()"
    *ngIf="!readonlyMode"
  >
    â• Ajouter une ligne
  </button>

  <div class="mt-4 d-flex justify-content-between">
    <button
      class="btn btn-success"
      (click)="confirmerBOM()"
      *ngIf="!readonlyMode"
    >
      âœ… Confirmer la nomenclature
    </button>
    <button class="btn btn-secondary" (click)="goBackToBomLines()">
      â¬… Retour
    </button>
  </div>
</div>
