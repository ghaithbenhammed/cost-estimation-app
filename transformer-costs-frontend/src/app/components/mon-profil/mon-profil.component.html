<div *ngIf="user; else loading" class="profile-wrapper">
  <div class="profile-panel">
    <div class="profile-header">
      <img [src]="user.profile_picture || 'assets/default-avatar.png'" class="avatar" alt="Photo de profil" />

      <label for="upload" class="upload-btn">
        ğŸ“· Modifier la photo
        <input type="file" id="upload" hidden (change)="onFileSelected($event)" />
      </label>
      <div *ngIf="photoMessage" class="toast-photo">
        {{ photoMessage }}
      </div>
      
      <h2 class="fullname">{{ user.first_name }} {{ user.last_name }}</h2>
    </div>

    <div class="profile-info" *ngIf="!isEditing; else editForm">
      <div class="info-row"><span class="label">ğŸ“§ Email</span> <span class="value">{{ user.email }}</span></div>
      <div class="info-row"><span class="label">ğŸ“ TÃ©lÃ©phone</span> <span class="value">{{ user.phone_number || 'N/A' }}</span></div>
      <div class="info-row"><span class="label">ğŸ“ Adresse</span> <span class="value">{{ user.address || 'N/A' }}</span></div>
      <div class="info-row"><span class="label">ğŸ›¡ï¸ RÃ´le</span> <span class="value">{{ user.role }}</span></div>
    </div>

    <ng-template #editForm>
      <div class="edit-grid">
        <input type="text" [(ngModel)]="formData.first_name" placeholder="PrÃ©nom" />
        <input type="text" [(ngModel)]="formData.last_name" placeholder="Nom" />
        <input type="text" [(ngModel)]="formData.phone_number" placeholder="TÃ©lÃ©phone" />
        <input type="text" [(ngModel)]="formData.address" placeholder="Adresse" />
      </div>
      <div class="btn-group">
        <button class="btn primary" (click)="onSave()">ğŸ’¾ Enregistrer</button>
        <button class="btn danger" (click)="onEdit()">âŒ Annuler</button>
      </div>
    </ng-template>

    <div *ngIf="!isEditing" class="btn-group">
      <button class="btn primary" (click)="onEdit()">âœï¸ Modifier le profil</button>
    </div>
  </div>
  <div *ngIf="successMessage" class="toast-success">
    {{ successMessage }}
  </div>
  
</div>

<ng-template #loading>
  <p class="loading-text">Chargement du profil...</p>
</ng-template>
