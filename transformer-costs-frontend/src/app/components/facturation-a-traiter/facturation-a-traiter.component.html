<div class="page-container mt-4">
  <h2 class="page-title">ğŸ“‹ Nomenclatures Ã  Facturer</h2>

  <div class="filter-container">
    <label for="statusFilter" class="filter-label">Filtrer :</label>
    <select id="statusFilter" [(ngModel)]="selectedStatus" (change)="applyFilter()" class="filter-select">
      <option value="all">Toutes</option>
      <option value="en_cours">En cours</option>
      <option value="emise">Ã‰mise</option>
    </select>
  </div>

  <div *ngIf="loading" class="loading-text">â³ Chargement en cours...</div>

  <div *ngIf="!loading && filteredBoms.length === 0" class="empty-message">
    ğŸ‰ Aucune nomenclature pour ce filtre.
  </div>

  <div *ngIf="!loading" class="card-container">
    <div class="card" *ngFor="let bom of filteredBoms">
      <div class="card-body">
        <button class="delete-btn" (click)="supprimerFacture(bom)">âœ–</button>
        <h5 class="card-title">
          ğŸ§¾ {{ bom.objet }}
          <span class="badge" [ngClass]="getStatusBadgeClass(bom.status)">
            {{ getStatusLabel(bom.status) }}
          </span>
        </h5>

        <p><strong>ğŸ“ Dossier :</strong> {{ bom.dossier }}</p>
        <p><strong>ğŸ‘¤ Client :</strong> {{ bom.client_name }}</p>
        <p><strong>ğŸ—“ï¸ Date :</strong> {{ bom.date_creation }}</p>

        <div class="action-buttons">
          <button class="btn-view"
             [disabled]="bom.status === 'emise'"
             [ngClass]="{ 'disabled': bom.status === 'emise' }"
             (click)="allerVersFacturation(bom.request)">
             ğŸ“„ GÃ©nÃ©rer Facture
          </button>
  
          <button class="btn-status"
                 [ngClass]="bom.status === 'en_cours' ? 'emise' : 'en-cours'"
                 (click)="changerStatut(bom)">
             {{ bom.status === 'en_cours' ? 'âœ… Marquer comme Ã‰mise' : 'â†©ï¸ Revenir Ã  En cours' }}
          </button>

        </div>
      </div>
    </div>
  </div>
</div>
